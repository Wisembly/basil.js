!function(){var e=function(n){return e.utils.extend({},e.plugins,(new e.Storage).init(n))};e.version="0.4.4",e.utils={extend:function(){for(var e="object"==typeof arguments[0]?arguments[0]:{},n=1;n<arguments.length;n++)if(arguments[n]&&"object"==typeof arguments[n])for(var t in arguments[n])e[t]=arguments[n][t];return e},each:function(e,n,t){if(this.isArray(e)){for(var i=0;i<e.length;i++)if(n.call(t,e[i],i)===!1)return}else if(e)for(var o in e)if(n.call(t,e[o],o)===!1)return},tryEach:function(e,n,t,i){this.each(e,function(e,o){try{return n.call(i,e,o)}catch(r){if(this.isFunction(t))try{t.call(i,e,o,r)}catch(r){}}},this)},registerPlugin:function(n){e.plugins=this.extend(n,e.plugins)},getTypeOf:function(e){return"undefined"==typeof e||null===e?""+e:Object.prototype.toString.call(e).replace(/^\[object\s(.*)\]$/,function(e,n){return n.toLowerCase()})}};for(var n=["Arguments","Boolean","Function","String","Array","Number","Date","RegExp","Undefined","Null"],t=0;t<n.length;t++)e.utils["is"+n[t]]=function(n){return function(t){return e.utils.getTypeOf(t)===n.toLowerCase()}}(n[t]);e.plugins={},e.options=e.utils.extend({namespace:"b45i1",storages:["local","cookie","session","memory"],expireDays:365},window.Basil?window.Basil.options:{}),e.Storage=function(){var n="b45i1"+(Math.random()+1).toString(36).substring(7),t={},i=function(n){var t=e.utils.getTypeOf(n);return"string"===t&&n||"number"===t||"boolean"===t},o=function(n){return e.utils.isArray(n)?n:e.utils.isString(n)?[n]:[]},r=function(n,t){var o="";return i(t)?o+=t:e.utils.isArray(t)&&(t=e.utils.isFunction(t.filter)?t.filter(i):t,o=t.join(".")),o&&i(n)?n+"."+o:o},s=function(e,n){return i(e)?n.replace(new RegExp("^"+e+"."),""):n},u=function(e){return JSON.stringify(e)},a=function(e){return e?JSON.parse(e):null},c={engine:null,check:function(){try{window[this.engine].setItem(n,!0),window[this.engine].removeItem(n)}catch(e){return!1}return!0},set:function(e,n,t){if(!e)throw Error("invalid key");window[this.engine].setItem(e,n)},get:function(e){return window[this.engine].getItem(e)},remove:function(e){window[this.engine].removeItem(e)},reset:function(e){for(var n,t=0;t<window[this.engine].length;t++)n=window[this.engine].key(t),e&&0!==n.indexOf(e)||(this.remove(n),t--)},keys:function(e){for(var n,t=[],i=0;i<window[this.engine].length;i++)n=window[this.engine].key(i),e&&0!==n.indexOf(e)||t.push(s(e,n));return t}};return t.local=e.utils.extend({},c,{engine:"localStorage"}),t.session=e.utils.extend({},c,{engine:"sessionStorage"}),t.memory={_hash:{},check:function(){return!0},set:function(e,n,t){if(!e)throw Error("invalid key");this._hash[e]=n},get:function(e){return this._hash[e]||null},remove:function(e){delete this._hash[e]},reset:function(e){for(var n in this._hash)e&&0!==n.indexOf(e)||this.remove(n)},keys:function(e){var n=[];for(var t in this._hash)e&&0!==t.indexOf(e)||n.push(s(e,t));return n}},t.cookie={check:function(){if(!navigator.cookieEnabled)return!1;if(window.self!==window.top){var e="thirdparty.check="+Math.round(1e3*Math.random());return document.cookie=e+"; path=/",-1!==document.cookie.indexOf(e)}return!0},set:function(e,n,t){if(!this.check())throw Error("cookies are disabled");if(t=t||{},!e)throw Error("invalid key");var i=encodeURIComponent(e)+"="+encodeURIComponent(n);if(t.expireDays){var o=new Date;o.setTime(o.getTime()+24*t.expireDays*60*60*1e3),i+="; expires="+o.toGMTString()}if(t.domain&&t.domain!==document.domain){var r=t.domain.replace(/^\./,"");if(-1===document.domain.indexOf(r)||r.split(".").length<=1)throw Error("invalid domain");i+="; domain="+t.domain}t.secure===!0&&(i+="; secure"),document.cookie=i+"; path=/"},get:function(e){if(!this.check())throw Error("cookies are disabled");for(var n,t=encodeURIComponent(e),i=document.cookie?document.cookie.split(";"):[],o=i.length-1;o>=0;o--)if(n=i[o].replace(/^\s*/,""),0===n.indexOf(t+"="))return decodeURIComponent(n.substring(t.length+1,n.length));return null},remove:function(e){this.set(e,"",{expireDays:-1});for(var n=document.domain.split("."),t=n.length;t>=0;t--)this.set(e,"",{expireDays:-1,domain:"."+n.slice(-t).join(".")})},reset:function(e){for(var n,t,i=document.cookie?document.cookie.split(";"):[],o=0;o<i.length;o++)n=i[o].replace(/^\s*/,""),t=n.substr(0,n.indexOf("=")),e&&0!==t.indexOf(e)||this.remove(t)},keys:function(e){if(!this.check())throw Error("cookies are disabled");for(var n,t,i=[],o=document.cookie?document.cookie.split(";"):[],r=0;r<o.length;r++)n=o[r].replace(/^\s*/,""),t=decodeURIComponent(n.substr(0,n.indexOf("="))),e&&0!==t.indexOf(e)||i.push(s(e,t));return i}},{init:function(e){return this.setOptions(e),this},setOptions:function(n){this.options=e.utils.extend({},this.options||e.options,n)},support:function(e){return t.hasOwnProperty(e)},check:function(e){return this.support(e)?t[e].check():!1},set:function(n,i,s){if(s=e.utils.extend({},this.options,s),!(n=r(s.namespace,n)))return!1;i=s.raw===!0?i:u(i);var a=null;return e.utils.tryEach(o(s.storages),function(e,o){return t[e].set(n,i,s),a=e,!1},null,this),a?(e.utils.tryEach(o(s.storages),function(e,i){e!==a&&t[e].remove(n)},null,this),!0):!1},get:function(n,i){if(i=e.utils.extend({},this.options,i),!(n=r(i.namespace,n)))return null;var s=null;return e.utils.tryEach(o(i.storages),function(e,o){return null!==s?!1:(s=t[e].get(n,i)||null,void(s=i.raw===!0?s:a(s)))},function(e,n,t){s=null},this),s},remove:function(n,i){i=e.utils.extend({},this.options,i),(n=r(i.namespace,n))&&e.utils.tryEach(o(i.storages),function(e){t[e].remove(n)},null,this)},reset:function(n){n=e.utils.extend({},this.options,n),e.utils.tryEach(o(n.storages),function(e){t[e].reset(n.namespace)},null,this)},keys:function(e){e=e||{};var n=[];for(var t in this.keysMap(e))n.push(t);return n},keysMap:function(n){n=e.utils.extend({},this.options,n);var i={};return e.utils.tryEach(o(n.storages),function(o){e.utils.each(t[o].keys(n.namespace),function(n){i[n]=e.utils.isArray(i[n])?i[n]:[],i[n].push(o)},this)},null,this),i}}},e.memory=(new e.Storage).init({storages:"memory",namespace:null,raw:!0}),e.cookie=(new e.Storage).init({storages:"cookie",namespace:null,raw:!0}),e.localStorage=(new e.Storage).init({storages:"local",namespace:null,raw:!0}),e.sessionStorage=(new e.Storage).init({storages:"session",namespace:null,raw:!0}),window.Basil=e,"function"==typeof define&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports&&(module.exports=e)}();